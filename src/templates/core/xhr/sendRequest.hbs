export const sendRequest = async (
	config: OpenAPIConfig,
	options: ApiRequestOptions,
	url: string,
	body: any,
	formData: FormData | undefined,
	headers: Headers,
	onCancel: OnCancel
): Promise<XMLHttpRequest> => {
	const xhr = new XMLHttpRequest();
	xhr.open(options.method, url, true);
	xhr.withCredentials = config.WITH_CREDENTIALS;

<<<<<<< HEAD
	headers.forEach((value, key) => {
		xhr.setRequestHeader(key, value);
	});
=======
    const xhr = new XMLHttpRequest();
    xhr.open(options.method, url, true);
    xhr.withCredentials = config.withCredentials ?? false;
>>>>>>> 1ee6314 (PE-2229 - rename OpenApi properties, remove config from http client, add config to request)

	return new Promise<XMLHttpRequest>((resolve, reject) => {
		xhr.onload = () => resolve(xhr);
		xhr.onabort = () => reject(new Error('Request aborted'));
		xhr.onerror = () => reject(new Error('Network error'));
		xhr.send(body ?? formData);

		onCancel(() => xhr.abort());
	});
};
